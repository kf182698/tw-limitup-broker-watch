# 台灣股漲停券商監控（LimitUp Broker Watch）

本專案旨在每天自動擷取台灣股票市場中 **收盤觸及漲停** 的個股，逐檔查詢其券商分點買賣超資料，
並比對您自訂的券商分點名單，以判斷是否出現隔日沖或特定主力分點鎖漲停的情況。

流程概要：

1. **擷取漲停清單**：從您設定的行情網址抓取當日的漲跌幅排行，篩選出收盤價觸及漲停的股票並留存。
2. **逐檔查券商分點明細**：對於每檔漲停股票，呼叫券商分點進出明細網址解析買進、賣出、買超等欄位，找出買超第一名的券商。
3. **比對自訂分點名單**：將買超第一名與 `config/brokers.yaml` 中設定的分點名單比對（名稱或券商代號），並套用各分點的特殊規則（例如買超佔比門檻）。
4. **通知**：將當日命中條件的個股整理為表格後，以 Email 通知到您指定的信箱。通知標題會是 `隔沖主力鎖漲停標的 <日期>`，內文含有股票、代號、收盤價、成交量、漲跌幅、買超券商、券商代號與買超張數等欄位。

所有抓取到的原始資料（HTML/CSV）以及整理好的結果都會依日期存放在 `data_raw/` 及 `data_clean/` 目錄中，以利日後追溯或回補歷史。

## 快速開始

1. **安裝依賴：**

```bash
pip install -r requirements.txt
```

2. **設定參數：**

請編輯 `config/settings.yaml`，填入行情網站的漲停清單網址以及券商明細網址模板，並設定通知信箱等資訊。  
在 `config/brokers.yaml` 中列出您關注的券商分點名稱或代碼，以及各分點的特殊規則（例如買超佔比限制）。

3. **執行：**

```bash
# 執行指定日期流程（系統會使用您輸入的日期）
python -m src.app.main run --date 2025-11-19
```

4. **排程自動化（GitHub Actions）：**

本專案提供 `.github/workflows/daily.yml`，示範如何使用 GitHub Actions 每個交易日自動執行並提交結果。  
您需要在 GitHub Repository 的 secrets 中設定 `SENDGRID_API_KEY` 或 `GMAIL_USER`/`GMAIL_PASS` 等環境變數才能寄信。

## 檔案與目錄說明

- `requirements.txt`：Python 套件依賴列表。
- `config/settings.yaml`：全域設定檔，包含時區、資料來源網址、漲停門檻及通知相關設定。
- `config/brokers.yaml`：您自訂的券商分點清單與各分點規則。
- `src/app`：共用函式與 CLI 入口程式。
- `src/source_site`：與資料來源相關的抓取與解析邏輯。
- `src/pipeline`：各處理流程的組裝，包括產生漲停列表、比對分點以及整理通知內容。
- `data_raw/`：存放每日抓取到的原始資料。
- `data_clean/`：存放整理後的結果，例如漲停清單與命中分點清單。
- `.github/workflows/daily.yml`：GitHub Actions 的範例排程。

## 注意事項

- 本專案未內建任何特定資料來源的網址或參數，請於 `config/settings.yaml` 中自行設定。  
- 程式預設使用 `requests` 搭配 retry/backoff 機制，建議遵守來源網站的服務條款及流量限制。  
- 郵件通知功能需自行提供第三方服務的金鑰或帳密，請勿將敏感資訊直接寫入程式碼庫，可使用 `.env` 或 GitHub Secrets 管理。

---

歡迎依照自身需求調整、擴充流程，例如加入歷史回補、更多過濾條件或其他資料來源等。